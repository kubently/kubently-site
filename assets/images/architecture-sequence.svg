<svg width="800" height="500" viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
    <filter id="dropShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur in="SourceAlpha" stdDeviation="3"/>
      <feOffset dx="2" dy="2" result="offsetblur"/>
      <feFlood flood-color="#000000" flood-opacity="0.1"/>
      <feComposite in2="offsetblur" operator="in"/>
      <feMerge>
        <feMergeNode/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
  </defs>

  <rect width="800" height="500" fill="#f8fafc" rx="12"/>

  <!-- Lanes -->
  <line x1="200" y1="50" x2="200" y2="450" stroke="#e2e8f0" stroke-dasharray="5,5"/>
  <line x1="400" y1="50" x2="400" y2="450" stroke="#e2e8f0" stroke-dasharray="5,5"/>
  <line x1="600" y1="50" x2="600" y2="450" stroke="#e2e8f0" stroke-dasharray="5,5"/>

  <!-- Headers -->
  <text x="100" y="40" font-family="sans-serif" font-weight="bold" text-anchor="middle" fill="#475569">Client</text>
  <text x="300" y="40" font-family="sans-serif" font-weight="bold" text-anchor="middle" fill="#475569">Kubently API</text>
  <text x="500" y="40" font-family="sans-serif" font-weight="bold" text-anchor="middle" fill="#475569">Redis</text>
  <text x="700" y="40" font-family="sans-serif" font-weight="bold" text-anchor="middle" fill="#475569">Executor</text>

  <!-- Step 1: SSE Connect -->
  <rect x="620" y="70" width="160" height="40" rx="4" fill="#1e293b" filter="url(#dropShadow)"/>
  <text x="700" y="95" font-family="sans-serif" font-size="12" fill="white" text-anchor="middle">Connect SSE Stream</text>
  <path d="M 620 90 L 380 90" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="500" y="80" font-family="sans-serif" font-size="10" fill="#64748b" text-anchor="middle">GET /executor/stream</text>

  <!-- Step 2: Client Request -->
  <rect x="20" y="130" width="160" height="40" rx="4" fill="#3b82f6" filter="url(#dropShadow)"/>
  <text x="100" y="155" font-family="sans-serif" font-size="12" fill="white" text-anchor="middle">Send Command</text>
  <path d="M 180 150 L 220 150" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Step 3: Publish -->
  <rect x="220" y="130" width="160" height="40" rx="4" fill="#3b82f6" filter="url(#dropShadow)"/>
  <text x="300" y="155" font-family="sans-serif" font-size="12" fill="white" text-anchor="middle">Process &amp; Auth</text>
  <path d="M 380 150 L 420 150" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <!-- Redis Pub -->
  <rect x="420" y="130" width="160" height="40" rx="4" fill="#14b8a6" filter="url(#dropShadow)"/>
  <text x="500" y="155" font-family="sans-serif" font-size="12" fill="white" text-anchor="middle">Publish Command</text>

  <!-- Step 4: SSE Push -->
  <path d="M 580 150 L 620 150" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrow)"/>
  <text x="600" y="140" font-family="sans-serif" font-size="10" fill="#d97706" text-anchor="middle">~50ms Latency</text>

  <rect x="620" y="130" width="160" height="40" rx="4" fill="#1e293b" filter="url(#dropShadow)"/>
  <text x="700" y="155" font-family="sans-serif" font-size="12" fill="white" text-anchor="middle">Execute Command</text>

  <!-- Step 5: Return Results -->
  <path d="M 700 170 L 700 220 L 380 220" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <rect x="220" y="200" width="160" height="40" rx="4" fill="#3b82f6" filter="url(#dropShadow)"/>
  <text x="300" y="225" font-family="sans-serif" font-size="12" fill="white" text-anchor="middle">Receive Results</text>

  <!-- Step 6: Store Results -->
  <path d="M 380 220 L 420 220" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>
  <rect x="420" y="200" width="160" height="40" rx="4" fill="#14b8a6" filter="url(#dropShadow)"/>
  <text x="500" y="225" font-family="sans-serif" font-size="12" fill="white" text-anchor="middle">Cache Result</text>

  <!-- Step 7: Client Poll -->
  <path d="M 180 300 L 220 300" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>
  <rect x="20" y="280" width="160" height="40" rx="4" fill="white" stroke="#64748b" filter="url(#dropShadow)"/>
  <text x="100" y="305" font-family="sans-serif" font-size="12" fill="#475569" text-anchor="middle">Get Result</text>

  <path d="M 380 300 L 420 300" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>
  <path d="M 420 320 L 380 320" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <rect x="20" y="350" width="160" height="40" rx="4" fill="#10b981" filter="url(#dropShadow)"/>
  <text x="100" y="375" font-family="sans-serif" font-size="12" fill="white" text-anchor="middle">Display Output</text>
  <path d="M 220 320 L 100 320 L 100 350" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow)"/>

</svg>